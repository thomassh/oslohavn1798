var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}},overlay,map,watchID;function initMap(){var center,options={center:{lat:59.909,lng:10.7508},zoom:17,minZoom:16,maxZoom:18,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControl:!1,fullscreenControl:!0,gestureHandling:"greedy"};map=new google.maps.Map(document.getElementById("map"),options);var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(59.90504,10.73888),new google.maps.LatLng(59.9137,10.75971)),srcImage;overlay=new OslohavnOverlay(bounds,"../img/oslohavn1798-kart.png",map);var icons={marker3d:"3d-punkt.svg",marker360:"360-punkt.svg",markerFilm:"film-punkt.svg",markerSpill:"spill-punkt.svg"},features=[{lat:59.9090502,lng:10.7537,type:"marker360",data:{id:"7kGPY",title:"Bordtomter"}},{lat:59.9095402,lng:10.7478,type:"marker360",data:{id:"7kGP9",title:"Tollbugata/Fred Olsens gate"}},{lat:59.9089502,lng:10.74988,type:"marker360",data:{id:"7kGPq",title:"Utenfor Tollboden"}},{lat:59.9092002,lng:10.74898,type:"marker360",data:{id:"7kGPK",title:"Strandgata/Tollbugata"}},{lat:59.9107702,lng:10.75035,type:"marker360",data:{id:"7kGP1",title:"Kjøpmann Meyer"}},{lat:59.9091202,lng:10.7475,type:"marker360",data:{id:"7kGPw",title:"Fred. Olsens gate"}},{lat:59.9088002,lng:10.7481,type:"marker360",data:{id:"7kGYc",title:"Grønningen"}},{lat:59.9082602,lng:10.74734,type:"marker360",data:{id:"7kGPk",title:"Fisketorget"}},{lat:59.910713,lng:10.749119,type:"marker360",data:{id:"7kGPb",title:"Inngangen til Paleet"}},{lat:59.9101702,lng:10.74855,type:"marker360",data:{id:"7kGPZ",title:"Fred. Olsens gate/Prinsens gate"}},{lat:59.9100002,lng:10.74958,type:"marker360",data:{id:"7kGPD",title:"Paleet og Paléhagen"}},{lat:59.9092002,lng:10.75153,type:"marker360",data:{id:"7kGPs",title:"Havnebassenget utenfor Paléhagen"}},{lat:59.9088002,lng:10.7507,type:"marker360",data:{id:"7kGPc",title:"Havnebassenget utenfor Tollboden"}},{lat:59.9074802,lng:10.75356,type:"marker3d",data:{id:"bac9cbe7113c447b8705c6e894744ff3",title:"Brinchs kran"}},{lat:59.9089502,lng:10.749499,type:"marker3d",data:{id:"24360d044f9e41b2a26eb26fbc4135ab",title:"Sjøboder"}},{lat:59.9091902,lng:10.7501,type:"marker3d",data:{id:"8ecf11be057f43a99319544a54e5465a",title:"Tollboden"}},{lat:59.9094202,lng:10.74803,type:"marker3d",data:{id:"fbbedd3820494d16b87130d4fa49470e",title:"Corps de garde"}},{lat:59.9126402,lng:10.7469,type:"marker3d",data:{id:"ad88057e7ecb40f58b333bb33037802c",title:"Oslo domkirke"}},{lat:59.9108202,lng:10.75069,type:"markerSpill",data:{id:"Kjeglebanen/index.html",title:"Kjeglebane-spill"}},{lat:59.908849,lng:10.751809,type:"markerFilm",data:{id:"x53I9o4jgks",title:"Oslo havn 1798"}}];isMobile.any()&&(features[23]={lat:59.9108202,lng:10.75069,type:"markerSpill",data:{id:"https://c.simmer.io/static/unityFrame/index.html?url=https%3A%2F%2Fsimmercdn.com%2Funity%2FRZffdeDw9pggAqlC58PnEn9tHAF3%2Fcontent%2Ffb2142db-d4ad-abab-9c79-a6f7a251da64&imagePath=screens/0.png",title:"Kjeglebane-spill (krever WebGL)"}});var templates={marker3d:function(data){return`<div id="iw-container"><div class="iw-content"><div class="sketchfab-embed-wrapper"><iframe width="260" height="379" \n      src="https://sketchfab.com/models/${data.id}/embed?annotation_cycle=8" frameborder="0" \n      allowvr allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" \n      onmousewheel=""></iframe></div><div class="iw-title"><p>${data.title}</p></div></div>`},marker360:function(data){return`<div id="iw-container"><div class="iw-content"><iframe width="260" height="379"\n  style="width: 260px; height: 379px; border: none;" frameborder="0" allow="vr,gyroscope,accelerometer,fullscreen"\n  scrolling="no" allowfullscreen="true" style="max-width: 100%;" \n  src="https://kuula.co/share/${data.id}?fs=1&vr=1&iosfs=1&thumbs=1&hideinst=1&chromeless=1&logo=-1"></iframe><div class="iw-title"><p>${data.title}</p></div></div></div>`},markerFilm:function(data){return`<div id="iw-container"><div class="iw-content"><iframe width="560" height="315" src="https://www.youtube.com/embed/${data.id}?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><div class="iw-title"><p>${data.title}</p></div></div></div>`},markerSpill:function(data){return`<div id="iw-container"><div class="iw-content"><iframe width="560" height="350"\n    src="${data.id}" style="border:0"></iframe><div class="iw-title"><p>${data.title}</p></div></div></div>`}},infoWindow=new google.maps.InfoWindow;features.forEach(function(feature){var marker=new google.maps.Marker({position:new google.maps.LatLng(feature.lat,feature.lng),icon:{url:"/img/"+icons[feature.type],scaledSize:new google.maps.Size(23,32)},map:map}),infoWindow=null,closeDelayed=!1,closeDelayHandler=function(){$(infoWindow.getWrapper()).removeClass("active"),setTimeout(function(){closeDelayed=!0,infoWindow.close()},300)},infoWindow=new SnazzyInfoWindow({marker:marker,wrapperClass:"custom-window",closeWhenOthersOpen:"true",offset:{top:"-60px"},edgeOffset:{top:50,right:60,bottom:50},border:!1,closeButtonMarkup:'<button type="button" class="custom-close"></button>',callbacks:{open:function(){$(this.getWrapper()).addClass("open")},afterOpen:function(){var wrapper=$(this.getWrapper());wrapper.addClass("active"),wrapper.find(".custom-close").on("click",closeDelayHandler)},beforeClose:function(){return!!closeDelayed||(closeDelayHandler(),!1)},afterClose:function(){var wrapper=$(this.getWrapper());wrapper.find(".custom-close").off(),wrapper.removeClass("open"),closeDelayed=!1}}});marker.addListener("click",function(){var template,content=(0,templates[feature.type])(feature.data);infoWindow.setContent(content),infoWindow.open(map,marker)})}),google.maps.event.addListener(infoWindow,"domready",function(){var iwOuter=$(".gm-style-iw"),iwBackground=iwOuter.prev();iwBackground.children(":nth-child(2)").css({display:"none"}),iwBackground.children(":nth-child(4)").css({display:"none"}),iwBackground.children(":nth-child(3)").find("div").children().css({"box-shadow":"none","z-index":"1",background:"#4f8bc6"});var iwCloseBtn=iwOuter.next();iwCloseBtn.css({opacity:"1",right:"8px",top:"5px",width:"23px",height:"23px","background-image":"url(img/x.svg)",border:"5px solid #4f8bc6","border-radius":"50%","box-shadow":"0 0 5px black","background-color":"#4f8bc6",overflow:"hidden"}),$(".iw-content").height()<140&&$(".iw-bottom-gradient").css({display:"none"}),iwCloseBtn.mouseout(function(){$(this).css({opacity:"1"})})})}function OslohavnOverlay(bounds,image,map){this.bounds_=bounds,this.image_=image,this.map_=map,this.div_=null,this.setMap(map)}function showPosition(){navigator.geolocation?autoUpdate():alert("Sorry, your browser does not support HTML5 geolocation.")}function successCallback(position){if(toggleWatchBtn.innerHTML="Slutt å spore meg",prevLat!=position.coords.latitude||prevLong!=position.coords.longitude){var prevLat=position.coords.latitude,prevLong=position.coords.longitude;console.log(prevLat,prevLong)}}OslohavnOverlay.prototype=new google.maps.OverlayView,OslohavnOverlay.prototype.onAdd=function(){var div=document.createElement("div");div.style.borderStyle="none",div.style.borderWidth="0px",div.style.position="absolute";var img=document.createElement("img"),panes;img.src=this.image_,img.style.width="100%",img.style.height="100%",img.style.position="absolute",div.appendChild(img),this.div_=div,this.getPanes().overlayLayer.appendChild(div)},OslohavnOverlay.prototype.draw=function(){var overlayProjection=this.getProjection(),sw=overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest()),ne=overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast()),div=this.div_;div.style.left=sw.x+"px",div.style.top=ne.y+"px",div.style.width=ne.x-sw.x+"px",div.style.height=sw.y-ne.y+"px"},OslohavnOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},OslohavnOverlay.prototype.hide=function(){this.div_&&(this.div_.style.visibility="hidden")},OslohavnOverlay.prototype.show=function(){this.div_&&(this.div_.style.visibility="visible")},OslohavnOverlay.prototype.toggle=function(){this.div_&&("hidden"===this.div_.style.visibility?this.show():this.hide())},initMap();var marker=null;function autoUpdate(){watchID=navigator.geolocation.watchPosition(function(position){toggleWatchBtn.innerHTML="Slutt å spore meg";var newPoint=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);marker?marker.setPosition(newPoint):marker=new google.maps.Marker({position:newPoint,map:map,icon:{url:"/img/current_location_smaller.svg",scaledSize:new google.maps.Size(18,28)}}),map.setCenter(newPoint)})}