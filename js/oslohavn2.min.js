var overlay,map,watchID;function initMap(){var center,options={center:{lat:59.909,lng:10.7508},zoom:17,minZoom:16,maxZoom:18,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},mapTypeControl:!1,fullscreenControl:!0,gestureHandling:"greedy"};map=new google.maps.Map(document.getElementById("map"),options);var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(59.90504,10.73888),new google.maps.LatLng(59.9137,10.75971)),srcImage;overlay=new OslohavnOverlay(bounds,"../img/oslohavn1798-kart.png",map)}function OslohavnOverlay(bounds,image,map){this.bounds_=bounds,this.image_=image,this.map_=map,this.div_=null,this.setMap(map)}function showPosition(){navigator.geolocation?autoUpdate():alert("Sorry, your browser does not support HTML5 geolocation.")}function successCallback(position){if(toggleWatchBtn.innerHTML="Slutt å spore meg",prevLat!=position.coords.latitude||prevLong!=position.coords.longitude){var prevLat=position.coords.latitude,prevLong=position.coords.longitude;console.log(prevLat,prevLong)}}function startWatch(){var toggleWatchBtn=document.getElementById("toggleWatchBtn");toggleWatchBtn.onclick=function(){watchID?(toggleWatchBtn.innerHTML="Hvor er jeg?",navigator.geolocation.clearWatch(watchID),watchID=!1):(toggleWatchBtn.innerHTML="Søker...",showPosition())}}OslohavnOverlay.prototype=new google.maps.OverlayView,OslohavnOverlay.prototype.onAdd=function(){var div=document.createElement("div");div.style.borderStyle="none",div.style.borderWidth="0px",div.style.position="absolute";var img=document.createElement("img"),panes;img.src=this.image_,img.style.width="100%",img.style.height="100%",img.style.position="absolute",div.appendChild(img),this.div_=div,this.getPanes().overlayLayer.appendChild(div)},OslohavnOverlay.prototype.draw=function(){var overlayProjection=this.getProjection(),sw=overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest()),ne=overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast()),div=this.div_;div.style.left=sw.x+"px",div.style.top=ne.y+"px",div.style.width=ne.x-sw.x+"px",div.style.height=sw.y-ne.y+"px"},OslohavnOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},OslohavnOverlay.prototype.hide=function(){this.div_&&(this.div_.style.visibility="hidden")},OslohavnOverlay.prototype.show=function(){this.div_&&(this.div_.style.visibility="visible")},OslohavnOverlay.prototype.toggle=function(){this.div_&&("hidden"===this.div_.style.visibility?this.show():this.hide())},window.onload=startWatch,initMap();var marker=null;function autoUpdate(){watchID=navigator.geolocation.watchPosition(function(position){toggleWatchBtn.innerHTML="Slutt å spore meg";var newPoint=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);marker?marker.setPosition(newPoint):marker=new google.maps.Marker({position:newPoint,map:map,icon:{url:"/img/current_location_smaller.svg",scaledSize:new google.maps.Size(18,28)}}),map.setCenter(newPoint)})}